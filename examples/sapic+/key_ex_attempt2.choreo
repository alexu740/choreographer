Functions: 
  public rksamsd/3
  private ls/2
Protocol:
  {
    A : A, B, s, sk(A,s)
    B : A, B, s, sk(B,s)
    s : A, B, s, sk(A,s), sk(B,s)
  }

  A->s: pair(A, B).
  lock(s). new KAB. unlock. s->A: pair(senc(KAB, sk(A,s)), senc(KAB, sk(B,s))).
                            A->B: pair(A, senc(KAB, sk(B,s))). nil

Goals:
KAB secret between A, B, s
A authenticates s on KAB
A authenticates s on B
B authenticates s on KAB
B authenticates s on A